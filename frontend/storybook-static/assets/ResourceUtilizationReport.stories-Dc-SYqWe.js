import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as s}from"./index-DQLiH3RP.js";import{r as y}from"./reportService-BqbW525N.js";import"./apiClient-CuU1bmnr.js";const p=()=>{const[c,j]=s.useState([]),[i,u]=s.useState(!0),[m,g]=s.useState(null),[a,N]=s.useState(""),[r,v]=s.useState(""),x=s.useCallback(async t=>{try{u(!0);const o={};t!=null&&t.applyFilters&&((t.fromDate||a)&&(o.from=t.fromDate||a),(t.toDate||r)&&(o.to=t.toDate||r));const l=await y.getResourceUtilizationReport(o);j(l),g(null)}catch{g("Failed to load report")}finally{u(!1)}},[a,r]);return s.useEffect(()=>{x()},[x]),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Resource Utilization Report"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Utilization percentage by resource"})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-x-auto",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Summary"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:a,onChange:t=>N(t.target.value),"data-testid":"util-from",className:"border border-gray-300 rounded-md px-2 py-1 text-sm"}),e.jsx("span",{className:"text-sm text-gray-500",children:"to"}),e.jsx("input",{type:"date",value:r,onChange:t=>v(t.target.value),"data-testid":"util-to",className:"border border-gray-300 rounded-md px-2 py-1 text-sm"}),e.jsx("button",{title:i?"Please wait until data finishes loading":void 0,disabled:i,onClick:()=>x({applyFilters:!0}),"data-testid":"util-apply",className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Apply"})]}),e.jsx("button",{title:i?"Please wait until data finishes loading":(c||[]).length===0?"No data to export":void 0,disabled:(c||[]).length===0&&!0,onClick:async()=>{const t={};a&&(t.from=a),r&&(t.to=r);const o=await y.exportReport("RESOURCE_UTILIZATION",t),l=URL.createObjectURL(o),d=document.createElement("a");d.href=l;const R=a||r?`_${a||"start"}_${r||"end"}`:"";d.download=`resource-utilization${R}.xlsx`,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(l)},"data-testid":"util-report-export",className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Export to Excel"})]})}),i&&e.jsx("div",{className:"px-6 py-12 text-center","data-testid":"util-report-loading",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})}),m&&!i&&e.jsx("div",{className:"px-6 py-4","data-testid":"util-report-error",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 text-sm text-red-700",children:m})}),!i&&!m&&e.jsxs("table",{className:"min-w-full divide-y divide-gray-200","data-testid":"util-report-table",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Resource"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilization"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(c||[]).map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.resourceName}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.utilizationPct.toFixed(0),"%"]})]},t.resourceName))})]})]})]})};p.__docgenInfo={description:"",methods:[],displayName:"ResourceUtilizationReportPage"};const S={title:"Reports/ResourceUtilizationReportPage",component:p},n={render:()=>e.jsx(p,{})};var h,b,f;n.parameters={...n.parameters,docs:{...(h=n.parameters)==null?void 0:h.docs,source:{originalSource:`{
  render: () => <ResourceUtilizationReportPage />
}`,...(f=(b=n.parameters)==null?void 0:b.docs)==null?void 0:f.source}}};const k=["Default"];export{n as Default,k as __namedExportsOrder,S as default};
